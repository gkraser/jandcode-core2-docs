Cfg
===

@@code-info module=jandcode.core class=jandcode.core.std.CfgService
class=jandcode.core.std.Cfg

Введение
--------

Полная конфигурация приложения загружается из `app.cfx` и доступна в приложении через
метод `App#getConf()`. Она включает в себя все, что нужно для приложения, включая
внутренние (системные) настройки. Эти настройки критичны для работы.

Однако при установке/настройке приложения необходимо вносить изменения в конфигурацию,
например настраивать соединения с базой данных.

Для обеспечения более безопасной модификации настроек вводится соглашение:
все параметры приложения, которые можно моифицировать при установке/запуске, хранятся в
узле `cfg`.

Например:

@@code file=cfg-example1.xml

Доступ к этой конфигурации должен осуществлятся через сервис
`jandcode.core.std.CfgService`:

@@code file=CfgExample1.groovy part=example1

Подстановки
-----------

В значениях параметров конфигурации можно использовать подстановки `${PATH}`, где `PATH` -
путь значения внутри узла `cfg`.

Например:

@@code file=cfg-subst1.xml

Получаем:

@@code file=CfgExample1.groovy part=subst1

### Игнорирование подстановок

Для некоторых параметров может понадобиться игнорировать подстановки, т.к. их обработкой
может заниматься кто-то другой и по особым правилам.

Для этого необходима такая настройка:

@@code file=expand-rule-ignore1.xml

Где:

* `name` - призвольное имя
* `mask` - маска пути внутри `cfg`, где подстановки игнорируются, например
  `dbsource/**/*`

Типизированный доступ к конфигурации
------------------------------------

Частенько удобнее получать значения параметров конфигурации не напрямую, через
`getConf()` с указанием пути, а через некий типизированный интерфейс. Такой интерфейс
упрощает работу со сложноорганизованными параметрами.

Для этого необходимо создать интерфейс, унаследовав его от
`jandcode.core.std.Cfg`, и описать методы, через которые будет осуществлятся доступ к
параметрам. Затем реализовать его и зарегистрировать реализацию в качестве бина
приложения.

Пример реализации:

@@code file=MyCfgExample.groovy

Пример регистрации:

@@code file=MyCfgExample.xml

Пример использования:

@@code file=CfgExample1.groovy part=useMyCfg1
                                      




