Dao
===

@@code-info module=jandcode.core.dao module=jandcode.core.dbm class=jandcode.core.dao.Dao
class=jandcode.core.dao.DaoService class=jandcode.core.dao.DaoMethod

Dao - это метод класса, который выполняется в определенном настроенном окружении.

Введение
--------

Пример простейшего dao:

@@code file=DaoSimple1.java

Для создания dao необходимо создать класс, который унаследован от
`jandcode.core.dao.BaseDao` и реализовать один или несколько публичных методов, которые
необходимо пометить аннотацией `@DaoMethod`. Каждый такой метод - dao.

Методы dao могут иметь произвольные параметры и возвращать произвольные результаты.
Это в случае, если dao выполняется локально в коде.
Если dao предназначен для вызова через внешнего клиента (например из браузера через 
определенный api), то нужно помнить, что можно использовать только те типы параметров 
и результата, которые разрешены этим api. 

В большинстве случаев безопасно использовать стандартные простые типы java
(int, long, String), списки List, мапы Map, даты `jandcode.commons.datetime.XDateTime`,
Store, StoreRecord.

Выполнение dao:

@@code file=DaoExamples1.groovy part=call1

`DaoService` содержит все, что касается dao. `DaoInvoker` среда исполнения dao.

Метод `createDao` создает экземпляр proxy-класса для указанного класса dao.
Вызовы dao-методов этого proxy-класса транслируются в среду исполнения конкретного
`DaoInvoker`, которая может производить всякие манипуляции и инициализации
(логгирование, установка соединения с базой данных, управление транзакциями и т.д.)
в процессе исполнения dao, одним из этапов которого будет вызов оригинального 
метода dao.

Для proxy-класса можно вызвать только dao-методы (помеченные аннотацией `@DaoMethod`),
вызов других методов приведет к ошибке. Например, в классе `DaoSimple1` из примера выше 
имеется публичный метод `noDaoMethod1`, его вызвать нельзя:

@@code file=DaoExamples1.groovy part=noDaoMethod1
                         
В dao-классах нет смысла делать пебличные методы, которые все равно вне вызвать нельзя.
Для внутренних нужд создавайте методы protected или private. 

Dao-классы не могут использоваться для разделения кода или какого-либо утилитного 
кода. Для этого предназначены утилитные классы.
                                
Кешировать экземпляры классов нельзя. Создали, выполнили метод, забыли.


Dao для базы данных
-------------------

Если dao желает иметь доступ к базе данных, то он реализовывается и исполняется
в контексте конкретной модели базы данных.

Такой dao необходимо унаследовать от класса `jandcode.core.dbm.dao.BaseModelDao`
и выполнять через DaoInvoker, которой принадлежит модели.

Пример dao для базы данных:

@@code file=DaoModel1.groovy

В методах dao доступен экземпляр `jandcode.core.dbm.mdb.Mdb` для выполнения
запросов к базе данных и различные утилиты для упрощения типичных задач.
Соединенение с базой данных и транзакции поддерживается средой исполнения dao, об этом
не нужно беспокоиться в процессе написания dao-методов.

Выполнение dao для модели:

@@code file=DaoExamples1.groovy part=callModel1


