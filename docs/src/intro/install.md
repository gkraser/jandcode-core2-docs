
Установка
=========

!!! note
    Инструкция предназначена для OS Windows 7/10
 
Настройка среды
---------------

Перед установкой **Jandcode Core** необходимо настроить среду.
Должно быть установлено следующее:

* Java JDK, версия 8
* [Gradle](https://gradle.org/), версия 5 или старше
* [Node.js](https://nodejs.org), версия 10.16.x или старше
* [Mercurial](https://www.mercurial-scm.org/), версия 4 или старше

В переменной `PATH` необходимо настроить пути так, что бы с командной строки
запускались приложения `java`, `javac`, `gradle`, `node`, `npm`, `hg`.

!!! note
    Из коробки поддерживается только IDE 
    [IntelliJ IDEA](https://www.jetbrains.com/idea/), версия 2018 или старше.


Установка 
---------

Проект **Jandcode Core** поставляется в исходниках и компилируется на машине
клиента.

Исходники доступны в репозитории mercurial: 
[](https://bitbucket.org/gkraser/jandcode-core2).  

Создаем произвольный рабочий каталог для проектов (например 
`D:\jc-projects`) 
и переходим в него:

```
cd /D D:\jc-projects
```

Клонируем репозиторий:

```
hg clone https://bitbucket.org/gkraser/jandcode-core2
```

Переходим в каталог `D:\jc-projects\jandcode-core2` и запускаем сборку проекта:

```
build-bin.bat
```

После окончания сборки имеем каталог `bin`, в котором собрана последняя
стабильная версия проекта. 

Необходимо обеспечить доступ к `jc.bat` с командной строки.
Для этого либо укажите каталог `D:\jc-projects\jandcode-core2\bin`
в переменной среды `PATH`, либо скопируйте файл 
`D:\jc-projects\jandcode-core2\bin\jc.bat` в каталог, который 
указан в переменной `PATH`.

Переходим в каталог `D:\jc-projects\jandcode-core2\bin` и запускаем настройку 
рабочего каталога для проектов:

```
jc create -t:jc-env -o:D:\jc-projects
```

В каталоге `D:\jc-projects` будут созданы файлы `jc-env.bat` и  `jc-env.jc`.

Далее переходим в каталог для проектов `D:\jc-projects` и запускаем 
`jc`, что бы убедится, что все работает:

```
cd /D D:\jc-projects
jc
```

В выводе обращаем внимание, что `jc-home` указывает на каталог с собранным
проектом:

```
 * jc-home: D:\jc-projects\jandcode-core2\bin
```   

Готово.


Обновление
----------

Что бы обновить версию до последней, выполните:

```
cd /D D:\jc-projects\jandcode-core2
build-bin.bat
```

Если версия изменилась, продукт будет пересобран.


Ветки default и dev
-------------------

!!! warning
    В ветке `default` находится стабильный релиз. Работоспособность
    других веток и ревизий не гарантируется.

В репозитории имеются 2 основных ветки: `default` и `dev`.

Ветка `default` содержит последний стабильный релиз.

Ветка `dev` содержит текущую версию для разработки.

Вы можете собирать бинарный вариант продукта из любой ветки, даже из любой ревиизии.
Просто обновите рабочий каталог с исходниками **Jandcode Core** до нужной Вам
ветки или ревизии. Например для `dev`:

```
cd /D D:\jc-projects\jandcode-core2
hg pull -u
hg update dev
build-bin.bat
```

Поддержка запуска jc версии 1.5
-------------------------------

Если вы используете Jandcode Core версии 1.5.x, то ее инструменты командной строки
так же запускаются через команду `jc`, которая конфликтует с новой версией. 

Для поддержки работоспособности старой версии
через новый вариант `jc.bat` необходимо в рабочем каталоге с проектам
на старой версии (в том, который содержит файл `jc-run.bat`) создать 
файл `jc-env.bat` с содержимым:

```
set JC_RUN=%~dp0jc-run.bat
```

Если Ваш старый `jc-run.bat` лежит в каком-то особом и загадочном месте,
то создайте файл `jc-env.bat` в каталоге выше Вашего проекта на старой версии
и в нем для переменной `JC_RUN` установите полный путь до `jc-run.bat`
старой версии.

Теперь запуск `jc` в рабочем каталоге с новой версией запустит новую,
а в рабочем каталоге со старой - старую.

 

